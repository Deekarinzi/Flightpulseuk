<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, viewport-fit=cover" name="viewport"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0B0E14">
    <title>FlightpulseUK - Global Live Flight Tracking</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        obsidian: "#0B0E14",
                        sky: "#00D1FF",
                        terminal: "#39FF14",
                        warning: "#FFB800",
                        cloud: "#F0F4F8",
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "0.5rem",
                        'xl': '0.75rem',
                        '2xl': '1rem',
                        '3xl': '1.5rem',
                    },
                    screens: {
                        'xs': '375px',
                        'sm': '640px',
                        'md': '768px',
                        'lg': '1024px',
                        'xl': '1280px',
                        '2xl': '1536px',
                    },
                },
            },
        };
    </script>
    <style type="text/tailwindcss">
        @layer base {
            body {
                @apply bg-obsidian text-cloud;
            }
        }
        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(0, 209, 255, 0.15);
        }
        .glass-hover:hover {
            border-color: rgba(0, 209, 255, 0.4);
            background: rgba(255, 255, 255, 0.05);
        }
        .hero-glow {
            background: radial-gradient(circle at top right, rgba(0, 209, 255, 0.12), transparent 60%);
        }
        .status-on-time {
            @apply bg-terminal/10 text-terminal border-terminal/30;
        }
        .status-delayed {
            @apply bg-warning/10 text-warning border-warning/30;
        }
        .nav-link {
            @apply hover:text-sky transition-colors duration-200 cursor-pointer;
        }
        .view-hidden {
            display: none !important;
        }
        .leaflet-container {
            background: #0B0E14 !important;
        }
        .aircraft-marker {
            transition: transform 0.3s ease;
        }
        .aircraft-marker:hover {
            transform: scale(1.2);
        }
        .custom-popup .leaflet-popup-content-wrapper {
            background: rgba(11, 14, 20, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 209, 255, 0.3);
            border-radius: 12px;
        }
        .custom-popup .leaflet-popup-tip {
            background: rgba(11, 14, 20, 0.95);
        }
        .custom-popup .leaflet-popup-content {
            margin: 12px;
            color: #F0F4F8;
        }
        /* Safe area for notched phones */
        .safe-bottom {
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }
        .safe-top {
            padding-top: env(safe-area-inset-top, 0px);
        }
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        /* Hide scrollbar but allow scrolling */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* Touch-friendly tap targets */
        .tap-target {
            min-height: 44px;
            min-width: 44px;
        }
        /* Responsive text */
        .text-responsive-xl {
            @apply text-3xl xs:text-4xl sm:text-5xl lg:text-7xl;
        }
        .text-responsive-lg {
            @apply text-xl sm:text-2xl lg:text-3xl;
        }
        /* Mobile-first card grid */
        .card-grid {
            @apply grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6;
        }
    </style>
</head>
<body class="font-display">

    <!-- ==================== NAVIGATION ==================== -->
    <nav class="sticky top-0 z-50 glass border-b border-sky/10 safe-top">
        <div class="max-w-7xl mx-auto px-3 sm:px-6 h-16 sm:h-20 flex items-center justify-between">
            <div class="flex items-center gap-4 lg:gap-10">
                <a onclick="showView('home')" class="flex items-center gap-2 group cursor-pointer tap-target">
                    <div class="bg-sky p-1 sm:p-1.5 rounded-lg shadow-[0_0_15px_rgba(0,209,255,0.4)]">
                        <span class="material-symbols-outlined text-obsidian text-xl sm:text-2xl font-bold">flight_takeoff</span>
                    </div>
                    <span class="text-lg sm:text-xl font-bold tracking-tight text-cloud">Flightpulse<span class="text-sky">UK</span></span>
                </a>
                <div class="hidden lg:flex items-center gap-8 text-sm font-medium text-cloud/70">
                    <a onclick="showView('map')" class="nav-link flex items-center gap-1">
                        <span class="material-symbols-outlined text-lg">map</span> Live Map
                    </a>
                    <a onclick="showToast('Airlines directory coming soon!', 'airlines')" class="nav-link">Airlines</a>
                    <a onclick="showToast('Airports directory coming soon!', 'location_city')" class="nav-link">Airports</a>
                    <a onclick="showToast('Schedules coming soon!', 'schedule')" class="nav-link">Schedules</a>
                </div>
            </div>
            <div class="flex items-center gap-2 sm:gap-4">
                <button onclick="toggleTheme()" class="p-2 rounded-full hover:bg-white/5 transition-colors text-sky tap-target">
                    <span id="theme-icon" class="material-symbols-outlined text-xl">light_mode</span>
                </button>
                <div class="h-6 w-px bg-white/10 mx-1 sm:mx-2 hidden sm:block"></div>
                <button onclick="openModal('signin-modal')" class="hidden sm:flex items-center gap-2 px-4 sm:px-5 py-2 rounded-full border border-sky/30 hover:bg-sky/10 hover:border-sky transition-all text-sky font-medium tap-target">
                    <span class="material-symbols-outlined text-xl">account_circle</span>
                    <span class="text-sm hidden sm:inline">Sign In</span>
                </button>
                <button onclick="openModal('signin-modal')" class="sm:hidden p-2 rounded-full hover:bg-white/5 transition-colors text-sky tap-target">
                    <span class="material-symbols-outlined text-xl">account_circle</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- ==================== HOME VIEW ==================== -->
    <main id="home-view" class="relative overflow-hidden hero-glow pb-20 md:pb-0">
        <!-- Hero Section -->
        <section class="max-w-7xl mx-auto px-4 sm:px-6 py-8 sm:py-12 md:py-16 lg:py-24">
            <div class="grid lg:grid-cols-2 gap-8 lg:gap-16 items-center">
                <div class="space-y-4 sm:space-y-6 lg:space-y-8 text-center lg:text-left">
                    <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-sky/10 text-sky text-[10px] sm:text-xs font-bold uppercase tracking-wider border border-sky/20">
                        <span class="relative flex h-2 w-2">
                            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-sky opacity-75"></span>
                            <span class="relative inline-flex rounded-full h-2 w-2 bg-sky"></span>
                        </span>
                        Live Global Radar
                    </div>
                    <h1 class="text-responsive-xl font-extrabold tracking-tight leading-[1.1] text-cloud">
                        Track Live Flights <span class="text-sky">Globally</span>
                    </h1>
                    <p class="text-base sm:text-lg md:text-xl text-cloud/60 leading-relaxed max-w-xl mx-auto lg:mx-0">
                        Real-time aviation data at your fingertips. UK's leading live flight tracker and status portal with precise radar coverage and delay updates.
                    </p>
                    <div class="flex flex-col xs:flex-row flex-wrap gap-3 sm:gap-4 justify-center lg:justify-start">
                        <button onclick="showView('map')" class="w-full xs:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-sky text-obsidian font-bold rounded-xl shadow-[0_0_20px_rgba(0,209,255,0.3)] hover:shadow-[0_0_30px_rgba(0,209,255,0.5)] hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2 tap-target">
                            <span class="material-symbols-outlined">map</span>
                            Open Interactive Map
                        </button>
                        <button onclick="showToast('Airlines directory coming soon!', 'airlines')" class="w-full xs:w-auto px-6 sm:px-8 py-3 sm:py-4 glass font-semibold rounded-xl text-sky hover:bg-sky/5 transition-all tap-target">
                            View Airlines
                        </button>
                    </div>
                </div>
                <div class="relative hidden lg:block">
                    <div class="absolute inset-0 bg-sky/10 blur-[120px] rounded-full"></div>
                    <img alt="3D render of a modern jet airplane flying through clouds" class="relative z-10 w-full rounded-3xl shadow-2xl transform rotate-2 hover:rotate-0 transition-transform duration-700 border border-sky/10" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCvZk7nnAZ9xqbuNUH0MKiA2KUhGt1pPk94xqAInlz4nTBb-1HlXXz8gJFc8iLigUV4LCVRB6Jax_Th07YKQlhwzSArxhLt5JJpZZK550eiVMHF2aTlo8Dk0M_uCf9wqIl9ZZDlMLOx2XQUb0vEHZuRS1kb7sqoozl4GKoLWLXSoJTfIUY0z1Vj16WfACiFPvQdcvQ2h21zVvtx8NB4VJ89ytZOa2HQnnQ_hJZGEfOdPs9v3fHlj_d25O9PneNjcOx1LbUhXL8LUMmP"/>
                </div>
            </div>
        </section>

        <!-- Search Section -->
        <section class="max-w-7xl mx-auto px-4 sm:px-6 -mt-4 sm:-mt-8 relative z-20">
            <div class="glass p-2 rounded-xl sm:rounded-2xl shadow-2xl border border-sky/20">
                <div class="flex flex-col md:flex-row items-center gap-2">
                    <div class="relative flex-1 w-full">
                        <span class="material-symbols-outlined absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 text-sky/50">search</span>
                        <input id="main-search" onkeypress="handleSearch(event)" class="w-full pl-10 sm:pl-12 pr-4 py-3 sm:py-4 bg-transparent border-none focus:ring-0 focus:outline-none placeholder:text-cloud/30 text-base sm:text-lg text-cloud" placeholder="Flight #, Route, or Airport..." type="text"/>
                    </div>
                    <div class="h-10 w-px bg-white/10 hidden md:block"></div>
                    <div class="flex items-center gap-2 sm:gap-4 px-2 sm:px-4 py-2 md:py-0 w-full md:w-auto">
                        <button onclick="showToast('Advanced filters coming soon!', 'tune')" class="flex items-center gap-1 sm:gap-2 text-xs sm:text-sm font-medium text-cloud/50 hover:text-sky transition-colors whitespace-nowrap tap-target">
                            <span class="material-symbols-outlined text-lg">tune</span> <span class="hidden xs:inline">Filters</span>
                        </button>
                        <button onclick="performSearch()" class="flex-1 md:flex-none px-6 sm:px-8 py-3 bg-sky text-obsidian font-bold rounded-xl hover:bg-sky/90 transition-colors tap-target">
                            Search
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Recent Searches -->
        <section class="max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8 lg:py-12">
            <div class="flex items-center justify-between mb-4 sm:mb-6">
                <h3 class="text-base sm:text-lg font-bold flex items-center gap-2 text-cloud">
                    <span class="material-symbols-outlined text-sky text-xl">history</span>
                    Recent Searches
                </h3>
                <button onclick="clearRecentSearches()" class="text-xs sm:text-sm font-semibold text-sky hover:underline tap-target">Clear All</button>
            </div>
            <div id="recent-searches" class="flex flex-wrap gap-2 sm:gap-3">
                <button onclick="searchFlight('BA205')" class="px-3 sm:px-5 py-2 sm:py-3 glass rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium text-cloud/80 hover:bg-sky/10 hover:border-sky/40 transition-all flex items-center gap-1 sm:gap-2 tap-target">
                    <span class="material-symbols-outlined text-sm text-sky">schedule</span> BA205
                </button>
                <button onclick="searchRoute('LHR', 'JFK')" class="px-3 sm:px-5 py-2 sm:py-3 glass rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium text-cloud/80 hover:bg-sky/10 hover:border-sky/40 transition-all flex items-center gap-1 sm:gap-2 tap-target">
                    <span class="material-symbols-outlined text-sm text-sky">route</span> LHR to JFK
                </button>
                <button onclick="searchFlight('VS3')" class="px-3 sm:px-5 py-2 sm:py-3 glass rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium text-cloud/80 hover:bg-sky/10 hover:border-sky/40 transition-all flex items-center gap-1 sm:gap-2 tap-target">
                    <span class="material-symbols-outlined text-sm text-sky">flight</span> VS3
                </button>
                <button onclick="showToast('Showing Heathrow Airport info', 'location_on')" class="px-3 sm:px-5 py-2 sm:py-3 glass rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium text-cloud/80 hover:bg-sky/10 hover:border-sky/40 transition-all flex items-center gap-1 sm:gap-2 tap-target">
                    <span class="material-symbols-outlined text-sm text-sky">location_on</span> Heathrow
                </button>
            </div>
        </section>

        <!-- Trending Flights -->
        <section class="max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8 lg:py-12 mb-16 sm:mb-20">
            <div class="flex items-center justify-between mb-4 sm:mb-6 lg:mb-8">
                <div>
                    <h2 class="text-xl sm:text-2xl font-bold text-cloud">Trending Flights</h2>
                    <p class="text-cloud/40 text-xs sm:text-sm mt-1">Most tracked flights in your region</p>
                </div>
                <div class="hidden sm:flex gap-2">
                    <button class="p-2 glass rounded-lg text-sky hover:bg-sky/10 tap-target"><span class="material-symbols-outlined">chevron_left</span></button>
                    <button class="p-2 glass rounded-lg text-sky hover:bg-sky/10 tap-target"><span class="material-symbols-outlined">chevron_right</span></button>
                </div>
            </div>

            <div class="card-grid">
                <!-- Flight Card 1 - BA217 -->
                <div onclick="showFlightDetails('BA217')" class="glass glass-hover p-4 sm:p-6 rounded-xl sm:rounded-2xl transition-all group cursor-pointer active:scale-[0.98]">
                    <div class="flex justify-between items-start mb-4 sm:mb-6">
                        <div class="flex items-center gap-2 sm:gap-3">
                            <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-lg sm:rounded-xl bg-white/5 flex items-center justify-center font-bold text-sky text-sm sm:text-base">BA</div>
                            <div>
                                <h4 class="font-bold text-cloud text-sm sm:text-base">BA217</h4>
                                <p class="text-[10px] sm:text-xs text-cloud/40">British Airways</p>
                            </div>
                        </div>
                        <span class="px-2 py-1 rounded text-[8px] sm:text-[10px] font-bold uppercase tracking-wider status-on-time border">On Time</span>
                    </div>
                    <div class="flex justify-between items-center relative py-3 sm:py-4">
                        <div class="text-center">
                            <h3 class="text-xl sm:text-2xl font-black text-cloud">LHR</h3>
                            <p class="text-[9px] sm:text-[10px] uppercase text-cloud/40">London</p>
                        </div>
                        <div class="flex-1 px-2 sm:px-4 relative">
                            <div class="h-[2px] w-full bg-white/10 rounded-full"></div>
                            <div class="h-[2px] w-[65%] bg-sky absolute top-3 sm:top-4 left-2 sm:left-4 rounded-full shadow-[0_0_8px_rgba(0,209,255,0.6)]"></div>
                            <span class="material-symbols-outlined absolute top-1/2 left-[65%] -translate-y-1/2 -translate-x-1/2 text-sky text-lg sm:text-xl rotate-90">flight</span>
                            <div class="absolute -bottom-3 sm:-bottom-4 left-1/2 -translate-x-1/2 text-[9px] sm:text-[10px] font-bold text-sky uppercase">In Air</div>
                        </div>
                        <div class="text-center">
                            <h3 class="text-xl sm:text-2xl font-black text-cloud">IAD</h3>
                            <p class="text-[9px] sm:text-[10px] uppercase text-cloud/40">Washington</p>
                        </div>
                    </div>
                    <div class="mt-6 sm:mt-8 flex justify-between items-center text-[10px] sm:text-xs font-medium text-cloud/40">
                        <span>Dep: 11:30 AM</span>
                        <span>Arr: 02:45 PM</span>
                    </div>
                </div>

                <!-- Flight Card 2 - VS3 -->
                <div onclick="showFlightDetails('VS3')" class="glass glass-hover p-4 sm:p-6 rounded-xl sm:rounded-2xl transition-all group cursor-pointer active:scale-[0.98]">
                    <div class="flex justify-between items-start mb-4 sm:mb-6">
                        <div class="flex items-center gap-2 sm:gap-3">
                            <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-lg sm:rounded-xl bg-white/5 flex items-center justify-center font-bold text-sky text-sm sm:text-base">VS</div>
                            <div>
                                <h4 class="font-bold text-cloud text-sm sm:text-base">VS3</h4>
                                <p class="text-[10px] sm:text-xs text-cloud/40">Virgin Atlantic</p>
                            </div>
                        </div>
                        <span class="px-2 py-1 rounded text-[8px] sm:text-[10px] font-bold uppercase tracking-wider status-delayed border">Delayed 15m</span>
                    </div>
                    <div class="flex justify-between items-center relative py-3 sm:py-4 opacity-75">
                        <div class="text-center">
                            <h3 class="text-xl sm:text-2xl font-black text-cloud">LHR</h3>
                            <p class="text-[9px] sm:text-[10px] uppercase text-cloud/40">London</p>
                        </div>
                        <div class="flex-1 px-2 sm:px-4 relative">
                            <div class="h-[2px] w-full border-t-2 border-dashed border-white/20"></div>
                            <span class="material-symbols-outlined absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 text-cloud/20 text-lg sm:text-xl rotate-90">flight</span>
                            <div class="absolute -bottom-3 sm:-bottom-4 left-1/2 -translate-x-1/2 text-[9px] sm:text-[10px] font-bold text-cloud/40 uppercase">Scheduled</div>
                        </div>
                        <div class="text-center">
                            <h3 class="text-xl sm:text-2xl font-black text-cloud">JFK</h3>
                            <p class="text-[9px] sm:text-[10px] uppercase text-cloud/40">New York</p>
                        </div>
                    </div>
                    <div class="mt-6 sm:mt-8 flex justify-between items-center text-[10px] sm:text-xs font-medium text-cloud/40">
                        <span>Dep: 02:15 PM</span>
                        <span>Arr: 05:05 PM</span>
                    </div>
                </div>

                <!-- Flight Card 3 - UA924 -->
                <div onclick="showFlightDetails('UA924')" class="glass glass-hover p-4 sm:p-6 rounded-xl sm:rounded-2xl transition-all group cursor-pointer active:scale-[0.98]">
                    <div class="flex justify-between items-start mb-4 sm:mb-6">
                        <div class="flex items-center gap-2 sm:gap-3">
                            <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-lg sm:rounded-xl bg-white/5 flex items-center justify-center font-bold text-sky text-sm sm:text-base">UA</div>
                            <div>
                                <h4 class="font-bold text-cloud text-sm sm:text-base">UA924</h4>
                                <p class="text-[10px] sm:text-xs text-cloud/40">United Airlines</p>
                            </div>
                        </div>
                        <span class="px-2 py-1 rounded text-[8px] sm:text-[10px] font-bold uppercase tracking-wider status-on-time border">On Time</span>
                    </div>
                    <div class="flex justify-between items-center relative py-3 sm:py-4">
                        <div class="text-center">
                            <h3 class="text-xl sm:text-2xl font-black text-cloud">IAD</h3>
                            <p class="text-[9px] sm:text-[10px] uppercase text-cloud/40">Washington</p>
                        </div>
                        <div class="flex-1 px-2 sm:px-4 relative">
                            <div class="h-[2px] w-full bg-white/10 rounded-full"></div>
                            <div class="h-[2px] w-[35%] bg-sky absolute top-3 sm:top-4 left-2 sm:left-4 rounded-full shadow-[0_0_8px_rgba(0,209,255,0.6)]"></div>
                            <span class="material-symbols-outlined absolute top-1/2 left-[35%] -translate-y-1/2 -translate-x-1/2 text-sky text-lg sm:text-xl rotate-90">flight</span>
                            <div class="absolute -bottom-3 sm:-bottom-4 left-1/2 -translate-x-1/2 text-[9px] sm:text-[10px] font-bold text-sky uppercase">In Air</div>
                        </div>
                        <div class="text-center">
                            <h3 class="text-xl sm:text-2xl font-black text-cloud">LHR</h3>
                            <p class="text-[9px] sm:text-[10px] uppercase text-cloud/40">London</p>
                        </div>
                    </div>
                    <div class="mt-6 sm:mt-8 flex justify-between items-center text-[10px] sm:text-xs font-medium text-cloud/40">
                        <span>Dep: 06:40 PM</span>
                        <span>Arr: 06:50 AM</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Stats Section -->
        <section class="max-w-7xl mx-auto px-4 sm:px-6 mb-16 sm:mb-20">
            <div class="p-5 sm:p-8 md:p-12 glass rounded-2xl sm:rounded-3xl border border-sky/20 relative overflow-hidden shadow-[0_0_40px_rgba(0,209,255,0.05)]">
                <div class="absolute top-0 right-0 w-48 sm:w-96 h-48 sm:h-96 bg-sky/5 rounded-full -mr-16 sm:-mr-32 -mt-16 sm:-mt-32 blur-[80px] sm:blur-[100px]"></div>
                <div class="max-w-3xl relative z-10">
                    <h2 class="text-xl sm:text-2xl md:text-3xl font-bold mb-3 sm:mb-6 text-cloud">Expert Flight Intelligence</h2>
                    <p class="text-cloud/60 leading-relaxed text-sm sm:text-base md:text-lg">
                        FlightpulseUK is the premier <span class="text-sky font-bold">live flight tracker</span> for real-time aviation enthusiasts. Get precise <span class="font-bold text-cloud">real-time flight tracker</span> data, including gate info, flight delays, and UK radar coverage.
                    </p>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6 md:gap-8 mt-6 sm:mt-8 md:mt-12">
                        <div class="text-center sm:text-left">
                            <div class="text-2xl sm:text-3xl font-black text-sky">180k+</div>
                            <div class="text-xs sm:text-sm font-medium text-cloud/40">Flights/Day</div>
                        </div>
                        <div class="text-center sm:text-left">
                            <div class="text-2xl sm:text-3xl font-black text-sky">1.2k+</div>
                            <div class="text-xs sm:text-sm font-medium text-cloud/40">Airlines</div>
                        </div>
                        <div class="text-center sm:text-left">
                            <div class="text-2xl sm:text-3xl font-black text-sky">4.5k+</div>
                            <div class="text-xs sm:text-sm font-medium text-cloud/40">Airports</div>
                        </div>
                        <div class="text-center sm:text-left">
                            <div class="text-2xl sm:text-3xl font-black text-sky">24/7</div>
                            <div class="text-xs sm:text-sm font-medium text-cloud/40">Live Coverage</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- ==================== MAP VIEW ==================== -->
    <div id="map-view" class="view-hidden fixed inset-0 z-40 bg-obsidian flex flex-col">
        <!-- Map Header -->
        <header class="glass border-b border-sky/10 p-4 z-50">
            <div class="max-w-7xl mx-auto flex items-center justify-between">
                <button onclick="showView('home')" class="flex items-center gap-2 text-cloud hover:text-sky transition-colors">
                    <span class="material-symbols-outlined">arrow_back</span>
                    <span class="font-medium">Back</span>
                </button>
                <div class="flex items-center gap-2">
                    <span class="relative flex h-2 w-2">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-terminal opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-terminal"></span>
                    </span>
                    <span class="text-xs font-bold uppercase tracking-wider text-terminal">Live Tracking</span>
                </div>
                <div class="flex items-center gap-2">
                    <button onclick="centerOnUserLocation()" class="p-2 glass rounded-lg text-sky hover:bg-sky/10">
                        <span class="material-symbols-outlined">my_location</span>
                    </button>
                    <button onclick="toggleMapLayers()" class="p-2 glass rounded-lg text-cloud hover:bg-sky/10">
                        <span class="material-symbols-outlined">layers</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Map Filters -->
        <div class="glass border-b border-sky/10 px-4 py-3 z-50">
            <div class="max-w-7xl mx-auto flex gap-2 overflow-x-auto">
                <button class="flex items-center gap-2 px-4 py-2 bg-sky text-obsidian rounded-full text-sm font-bold whitespace-nowrap">
                    <span class="material-symbols-outlined text-lg">sensors</span> Live Tracking
                </button>
                <button onclick="centerOnLHR()" class="flex items-center gap-2 px-4 py-2 glass rounded-full text-sm font-medium text-cloud whitespace-nowrap hover:bg-sky/10">
                    <span class="material-symbols-outlined text-lg">location_on</span> London (LHR)
                </button>
                <button onclick="showToast('Showing arrivals only', 'flight_land')" class="flex items-center gap-2 px-4 py-2 glass rounded-full text-sm font-medium text-cloud whitespace-nowrap hover:bg-sky/10">
                    <span class="material-symbols-outlined text-lg">flight_land</span> Arrivals
                </button>
                <button onclick="showToast('Showing departures only', 'flight_takeoff')" class="flex items-center gap-2 px-4 py-2 glass rounded-full text-sm font-medium text-cloud whitespace-nowrap hover:bg-sky/10">
                    <span class="material-symbols-outlined text-lg">flight_takeoff</span> Departures
                </button>
            </div>
        </div>

        <!-- Leaflet Map Container -->
        <div id="leaflet-map" class="flex-1 relative z-0"></div>

        <!-- Map Loading Indicator -->
        <div id="map-loading" class="absolute inset-0 flex items-center justify-center z-20 bg-obsidian">
            <div class="flex flex-col items-center gap-3">
                <div class="w-10 h-10 border-3 border-sky border-t-transparent rounded-full animate-spin"></div>
                <p class="text-cloud/60 text-sm">Loading live aircraft...</p>
            </div>
        </div>

        <!-- Flight Info Card -->
        <div id="map-flight-card" class="absolute bottom-20 left-4 right-4 md:left-auto md:right-4 md:w-96 glass rounded-2xl border border-sky/20 z-50 view-hidden">
            <div class="p-4">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <div class="flex items-center gap-2">
                            <h3 id="map-flight-callsign" class="text-xl font-bold text-cloud">BA458</h3>
                            <span id="map-flight-status" class="px-2 py-0.5 rounded text-[10px] font-bold uppercase status-on-time border">On Time</span>
                        </div>
                        <p id="map-flight-airline" class="text-xs text-cloud/60 mt-0.5">British Airways • Airbus A320</p>
                    </div>
                    <button onclick="hideMapFlightCard()" class="text-cloud/60 hover:text-cloud">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="flex items-center justify-between gap-4 mb-4">
                    <div class="text-left">
                        <h4 id="map-flight-origin" class="text-2xl font-bold text-cloud">LHR</h4>
                        <p class="text-[10px] text-cloud/40 uppercase">Departure</p>
                    </div>
                    <div class="flex-1 flex items-center">
                        <div class="h-0.5 flex-1 bg-white/10 rounded-full overflow-hidden">
                            <div id="map-flight-progress" class="h-full bg-sky w-2/3"></div>
                        </div>
                        <span class="material-symbols-outlined text-sky text-sm rotate-90 mx-1">flight</span>
                        <div class="h-0.5 flex-1 bg-white/10"></div>
                    </div>
                    <div class="text-right">
                        <h4 id="map-flight-dest" class="text-2xl font-bold text-cloud">CDG</h4>
                        <p class="text-[10px] text-cloud/40 uppercase">Arrival</p>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="showFlightDetails(document.getElementById('map-flight-callsign').textContent)" class="py-3 bg-sky text-obsidian rounded-xl font-bold text-sm flex items-center justify-center gap-2">
                        <span class="material-symbols-outlined text-lg">info</span> Details
                    </button>
                    <button onclick="subscribeToAlerts()" class="py-3 glass text-cloud rounded-xl font-medium text-sm flex items-center justify-center gap-2 hover:bg-sky/10">
                        <span class="material-symbols-outlined text-lg">notifications</span> Alerts
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== FLIGHT DETAILS VIEW ==================== -->
    <div id="details-view" class="view-hidden min-h-screen pb-24">
        <!-- Details Header -->
        <header class="sticky top-0 z-50 glass border-b border-sky/10">
            <div class="max-w-4xl mx-auto px-6 h-16 flex items-center justify-between">
                <button onclick="showView('home')" class="flex items-center gap-2 text-cloud hover:text-sky transition-colors">
                    <span class="material-symbols-outlined">arrow_back</span>
                </button>
                <div class="flex flex-col items-center">
                    <h2 id="details-title" class="text-lg font-bold text-cloud">BA217 Status</h2>
                    <div class="flex items-center gap-1.5">
                        <span class="relative flex h-2 w-2">
                            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-terminal opacity-75"></span>
                            <span class="relative inline-flex rounded-full h-2 w-2 bg-terminal"></span>
                        </span>
                        <span class="text-[10px] font-bold uppercase tracking-wider text-terminal">Live Tracking</span>
                    </div>
                </div>
                <button onclick="shareFlight()" class="text-cloud hover:text-sky transition-colors">
                    <span class="material-symbols-outlined">share</span>
                </button>
            </div>
        </header>

        <main class="max-w-4xl mx-auto px-6 py-8">
            <!-- Flight Overview -->
            <div class="glass rounded-2xl p-6 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <div class="text-center">
                        <p id="details-origin" class="text-4xl font-extrabold text-cloud">LHR</p>
                        <p id="details-origin-city" class="text-sm text-cloud/60">London</p>
                    </div>
                    <div class="flex-1 flex flex-col items-center px-8">
                        <span class="material-symbols-outlined text-sky text-4xl rotate-90">flight</span>
                        <p id="details-status" class="text-sky text-sm font-bold mt-2">En Route - On Time</p>
                    </div>
                    <div class="text-center">
                        <p id="details-dest" class="text-4xl font-extrabold text-cloud">IAD</p>
                        <p id="details-dest-city" class="text-sm text-cloud/60">Washington</p>
                    </div>
                </div>
                <p id="details-aircraft" class="text-center text-cloud/40 text-sm">Boeing 777-300ER • G-STBJ</p>
            </div>

            <!-- Progress Bar -->
            <div class="glass rounded-2xl p-6 mb-6">
                <div class="flex justify-between items-end mb-4">
                    <div>
                        <p class="text-cloud/40 text-xs uppercase tracking-wider">Remaining</p>
                        <p id="details-remaining" class="text-2xl font-bold text-cloud">2h 15m</p>
                    </div>
                    <p id="details-percent" class="text-cloud/40 text-sm">65% Completed</p>
                </div>
                <div class="rounded-full bg-white/10 h-3 overflow-hidden">
                    <div id="details-progress-bar" class="h-full rounded-full bg-sky shadow-[0_0_8px_rgba(0,209,255,0.6)]" style="width: 65%;"></div>
                </div>
                <div class="flex justify-between mt-4 text-xs text-cloud/40">
                    <span id="details-dep-time">Departed: 11:30 AM</span>
                    <span id="details-arr-time">Est. Arrival: 02:45 PM</span>
                </div>
            </div>

            <!-- Stats Grid -->
            <h3 class="text-xl font-bold text-cloud mb-4">Flight Details</h3>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8">
                <div class="glass rounded-xl p-4">
                    <p class="text-cloud/40 text-xs uppercase mb-1">Departure Gate</p>
                    <p id="details-dep-gate" class="text-xl font-bold text-cloud">Terminal 5, B32</p>
                </div>
                <div class="glass rounded-xl p-4">
                    <p class="text-cloud/40 text-xs uppercase mb-1">Arrival Gate</p>
                    <p id="details-arr-gate" class="text-xl font-bold text-cloud">Terminal B, 44</p>
                </div>
                <div class="glass rounded-xl p-4">
                    <p class="text-cloud/40 text-xs uppercase mb-1">Altitude</p>
                    <p id="details-altitude" class="text-xl font-bold text-cloud">36,000 ft</p>
                </div>
                <div class="glass rounded-xl p-4">
                    <p class="text-cloud/40 text-xs uppercase mb-1">Ground Speed</p>
                    <p id="details-speed" class="text-xl font-bold text-cloud">510 kts</p>
                </div>
                <div class="glass rounded-xl p-4">
                    <p class="text-cloud/40 text-xs uppercase mb-1">Squawk</p>
                    <p id="details-squawk" class="text-xl font-bold text-cloud">7421</p>
                </div>
                <div class="glass rounded-xl p-4">
                    <p class="text-cloud/40 text-xs uppercase mb-1">Vertical Speed</p>
                    <p id="details-vspeed" class="text-xl font-bold text-cloud">0 fpm</p>
                </div>
            </div>

            <!-- Route Info -->
            <div class="glass rounded-2xl p-6 mb-6 border border-sky/20">
                <h3 class="text-sky font-bold mb-3">About This Route</h3>
                <p id="details-route-info" class="text-cloud/60 text-sm leading-relaxed">
                    This British Airways flight operates daily between London Heathrow (LHR) and Washington Dulles (IAD). The route spans approximately 3,665 miles with an average flight time of 8 hours and 15 minutes.
                </p>
                <div class="flex gap-2 mt-4 flex-wrap">
                    <span class="px-2 py-1 bg-white/5 rounded text-[10px] font-bold text-cloud/40 uppercase">#FlightTracker</span>
                    <span class="px-2 py-1 bg-white/5 rounded text-[10px] font-bold text-cloud/40 uppercase">#LHRtoIAD</span>
                    <span class="px-2 py-1 bg-white/5 rounded text-[10px] font-bold text-cloud/40 uppercase">#LiveFlightStatus</span>
                </div>
            </div>

            <!-- Historical Performance -->
            <div class="glass rounded-2xl p-6">
                <h4 class="font-bold text-cloud mb-4">Historical Performance</h4>
                <div class="flex justify-between items-center mb-2">
                    <span class="text-cloud/40 text-sm">On-time Rating</span>
                    <span class="font-bold text-terminal">Great (88%)</span>
                </div>
                <div class="rounded-full bg-white/10 h-2 overflow-hidden">
                    <div class="h-full rounded-full bg-terminal" style="width: 88%"></div>
                </div>
                <p class="text-cloud/40 text-xs mt-4 italic">Based on the last 30 days of flight data. Use FlightpulseUK for the most accurate flight status tracking.</p>
            </div>
        </main>

        <!-- Sticky Footer -->
        <div class="fixed bottom-0 left-0 right-0 glass border-t border-sky/10 p-4 z-50">
            <div class="max-w-4xl mx-auto flex gap-3">
                <button onclick="subscribeToAlerts()" class="flex-1 py-3 bg-sky text-obsidian font-bold rounded-xl flex items-center justify-center gap-2 shadow-[0_0_15px_rgba(0,209,255,0.3)]">
                    <span class="material-symbols-outlined">notifications_active</span> Get Alerts
                </button>
                <button onclick="showView('map')" class="w-14 glass rounded-xl flex items-center justify-center text-sky hover:bg-sky/10">
                    <span class="material-symbols-outlined">map</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ==================== FOOTER ==================== -->
    <footer id="main-footer" class="bg-obsidian border-t border-sky/10 py-16">
        <div class="max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-4 gap-12">
            <div class="col-span-1 md:col-span-1">
                <div class="flex items-center gap-2 mb-6">
                    <div class="bg-sky p-1.5 rounded-lg">
                        <span class="material-symbols-outlined text-obsidian text-xl font-bold">flight_takeoff</span>
                    </div>
                    <span class="text-xl font-bold tracking-tight text-cloud">Flightpulse<span class="text-sky">UK</span></span>
                </div>
                <p class="text-sm text-cloud/50 leading-relaxed mb-6">
                    Providing the most accurate real-time aviation data for travelers and enthusiasts across the United Kingdom.
                </p>
            </div>
            <div>
                <h4 class="font-bold mb-6 text-cloud">Tracking</h4>
                <ul class="space-y-4 text-sm text-cloud/50">
                    <li><a onclick="showView('map')" class="nav-link">Live Map</a></li>
                    <li><a onclick="showToast('Search by flight number', 'search')" class="nav-link">By Flight Number</a></li>
                    <li><a onclick="showToast('Search by route', 'route')" class="nav-link">By Route</a></li>
                    <li><a onclick="showToast('Arrivals/Departures coming soon', 'schedule')" class="nav-link">Arrivals/Departures</a></li>
                </ul>
            </div>
            <div>
                <h4 class="font-bold mb-6 text-cloud">Directory</h4>
                <ul class="space-y-4 text-sm text-cloud/50">
                    <li><a onclick="showToast('Airlines directory coming soon', 'airlines')" class="nav-link">Airlines</a></li>
                    <li><a onclick="showToast('Airports directory coming soon', 'location_city')" class="nav-link">Airports</a></li>
                    <li><a onclick="showToast('Fleet data coming soon', 'inventory')" class="nav-link">Fleet Data</a></li>
                    <li><a onclick="showToast('Aviation news coming soon', 'newspaper')" class="nav-link">Aviation News</a></li>
                </ul>
            </div>
            <div>
                <h4 class="font-bold mb-6 text-cloud">Support</h4>
                <ul class="space-y-4 text-sm text-cloud/50">
                    <li><a onclick="showToast('Help center coming soon', 'help')" class="nav-link">Help Center</a></li>
                    <li><a onclick="showToast('API services coming soon', 'api')" class="nav-link">API Services</a></li>
                    <li><a onclick="showToast('Privacy policy', 'privacy_tip')" class="nav-link">Privacy Policy</a></li>
                    <li><a onclick="showToast('Terms of service', 'gavel')" class="nav-link">Terms of Service</a></li>
                </ul>
            </div>
        </div>
        <div class="max-w-7xl mx-auto px-6 mt-16 pt-8 border-t border-sky/10 flex flex-col md:flex-row justify-between items-center gap-4">
            <p class="text-xs text-cloud/40">© 2024 FlightpulseUK. All rights reserved.</p>
            <div class="flex items-center gap-6">
                <span class="text-xs text-cloud/40 flex items-center gap-1">
                    <span class="w-2 h-2 rounded-full bg-terminal"></span> System Status: Operational
                </span>
            </div>
        </div>
    </footer>

    <!-- ==================== MOBILE BOTTOM NAV ==================== -->
    <div id="mobile-nav" class="fixed bottom-0 left-0 right-0 glass border-t border-sky/20 md:hidden z-50 px-6 py-3 flex justify-between items-center">
        <button onclick="showView('home')" id="nav-home" class="flex flex-col items-center gap-1 text-sky">
            <span class="material-symbols-outlined" style="font-variation-settings: 'FILL' 1">home</span>
            <span class="text-[10px] font-bold">Home</span>
        </button>
        <button onclick="showView('map')" id="nav-map" class="flex flex-col items-center gap-1 text-cloud/40">
            <span class="material-symbols-outlined">map</span>
            <span class="text-[10px] font-bold">Map</span>
        </button>
        <button onclick="openModal('alerts-modal')" id="nav-alerts" class="flex flex-col items-center gap-1 text-cloud/40">
            <span class="material-symbols-outlined">notifications</span>
            <span class="text-[10px] font-bold">Alerts</span>
        </button>
        <button onclick="openModal('saved-modal')" id="nav-saved" class="flex flex-col items-center gap-1 text-cloud/40">
            <span class="material-symbols-outlined">bookmark</span>
            <span class="text-[10px] font-bold">Saved</span>
        </button>
    </div>

    <!-- ==================== MODALS ==================== -->
    
    <!-- Sign In Modal -->
    <div id="signin-modal" class="fixed inset-0 z-[100] view-hidden">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="closeModal('signin-modal')"></div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-6">
            <div class="glass rounded-2xl border border-sky/20 p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-cloud">Sign In</h3>
                    <button onclick="closeModal('signin-modal')" class="text-cloud/60 hover:text-cloud">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="text-sm text-cloud/60 block mb-2">Email</label>
                        <input type="email" class="w-full px-4 py-3 bg-white/5 border border-sky/20 rounded-xl text-cloud focus:outline-none focus:border-sky" placeholder="you@example.com">
                    </div>
                    <div>
                        <label class="text-sm text-cloud/60 block mb-2">Password</label>
                        <input type="password" class="w-full px-4 py-3 bg-white/5 border border-sky/20 rounded-xl text-cloud focus:outline-none focus:border-sky" placeholder="••••••••">
                    </div>
                    <button onclick="showToast('Sign in coming soon!', 'login'); closeModal('signin-modal');" class="w-full py-3 bg-sky text-obsidian font-bold rounded-xl">Sign In</button>
                    <p class="text-center text-cloud/40 text-sm">Don't have an account? <a onclick="showToast('Sign up coming soon!', 'person_add')" class="text-sky cursor-pointer">Sign Up</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Alerts Modal -->
    <div id="alerts-modal" class="fixed inset-0 z-[100] view-hidden">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="closeModal('alerts-modal')"></div>
        <div class="absolute bottom-0 left-0 right-0 glass rounded-t-3xl border-t border-sky/20 p-6 max-h-[70vh] overflow-y-auto">
            <div class="w-12 h-1 bg-cloud/20 rounded-full mx-auto mb-4"></div>
            <h3 class="text-xl font-bold text-cloud mb-4 flex items-center gap-2">
                <span class="material-symbols-outlined text-sky">notifications</span> Flight Alerts
            </h3>
            <div class="space-y-3">
                <div class="glass rounded-xl p-4 border border-terminal/20">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-terminal/20 rounded-full flex items-center justify-center">
                            <span class="material-symbols-outlined text-terminal">flight_takeoff</span>
                        </div>
                        <div class="flex-1">
                            <p class="font-semibold text-cloud">BA217 Departed</p>
                            <p class="text-xs text-cloud/40">Left London Heathrow on time</p>
                        </div>
                        <span class="text-xs text-cloud/40">2m ago</span>
                    </div>
                </div>
                <div class="glass rounded-xl p-4 border border-warning/20">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-warning/20 rounded-full flex items-center justify-center">
                            <span class="material-symbols-outlined text-warning">schedule</span>
                        </div>
                        <div class="flex-1">
                            <p class="font-semibold text-cloud">VS3 Delayed</p>
                            <p class="text-xs text-cloud/40">New departure time: 02:30 PM</p>
                        </div>
                        <span class="text-xs text-cloud/40">15m ago</span>
                    </div>
                </div>
            </div>
            <button onclick="closeModal('alerts-modal')" class="w-full mt-4 py-3 glass rounded-xl text-cloud font-medium">Close</button>
        </div>
    </div>

    <!-- Saved Modal -->
    <div id="saved-modal" class="fixed inset-0 z-[100] view-hidden">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="closeModal('saved-modal')"></div>
        <div class="absolute bottom-0 left-0 right-0 glass rounded-t-3xl border-t border-sky/20 p-6 max-h-[70vh] overflow-y-auto">
            <div class="w-12 h-1 bg-cloud/20 rounded-full mx-auto mb-4"></div>
            <h3 class="text-xl font-bold text-cloud mb-4 flex items-center gap-2">
                <span class="material-symbols-outlined text-sky">bookmark</span> Saved Flights
            </h3>
            <div class="space-y-3">
                <div onclick="closeModal('saved-modal'); showFlightDetails('BA217');" class="glass rounded-xl p-4 cursor-pointer hover:border-sky/40 transition-colors">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <span class="font-bold text-cloud">BA217</span>
                            <span class="px-2 py-0.5 text-[10px] font-bold uppercase status-on-time rounded border">On Time</span>
                        </div>
                        <span class="material-symbols-outlined text-sky" style="font-variation-settings: 'FILL' 1">bookmark</span>
                    </div>
                    <div class="flex items-center gap-2 mt-2 text-sm">
                        <span class="text-cloud">LHR</span>
                        <span class="material-symbols-outlined text-cloud/40 text-sm rotate-90">flight</span>
                        <span class="text-cloud">IAD</span>
                        <span class="text-cloud/40 ml-auto text-xs">Today, 11:30 AM</span>
                    </div>
                </div>
                <div onclick="closeModal('saved-modal'); showFlightDetails('VS3');" class="glass rounded-xl p-4 cursor-pointer hover:border-sky/40 transition-colors">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <span class="font-bold text-cloud">VS3</span>
                            <span class="px-2 py-0.5 text-[10px] font-bold uppercase status-delayed rounded border">Delayed</span>
                        </div>
                        <span class="material-symbols-outlined text-sky" style="font-variation-settings: 'FILL' 1">bookmark</span>
                    </div>
                    <div class="flex items-center gap-2 mt-2 text-sm">
                        <span class="text-cloud">LHR</span>
                        <span class="material-symbols-outlined text-cloud/40 text-sm rotate-90">flight</span>
                        <span class="text-cloud">JFK</span>
                        <span class="text-cloud/40 ml-auto text-xs">Today, 02:15 PM</span>
                    </div>
                </div>
            </div>
            <button onclick="closeModal('saved-modal')" class="w-full mt-4 py-3 glass rounded-xl text-cloud font-medium">Close</button>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-24 left-1/2 -translate-x-1/2 z-[200] transform transition-all duration-300 opacity-0 -translate-y-4 pointer-events-none">
        <div class="glass border border-sky/30 rounded-xl px-5 py-3 shadow-2xl flex items-center gap-3">
            <span id="toast-icon" class="material-symbols-outlined text-sky">notifications</span>
            <p id="toast-message" class="text-cloud text-sm font-medium">Notification</p>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

    <script>
        // ==================== STATE ====================
        let map = null;
        let flightMarkers = {};
        let selectedFlight = null;

        // ==================== FLIGHT DATA ====================
        const FLIGHTS_DATA = {
            'BA217': {
                callsign: 'BA217',
                airline: 'British Airways',
                aircraft: 'Boeing 777-300ER',
                registration: 'G-STBJ',
                origin: 'LHR',
                originCity: 'London',
                destination: 'IAD',
                destCity: 'Washington',
                status: 'On Time',
                isDelayed: false,
                progress: 65,
                remaining: '2h 15m',
                depTime: '11:30 AM',
                arrTime: '02:45 PM',
                depGate: 'Terminal 5, B32',
                arrGate: 'Terminal B, 44',
                altitude: '36,000 ft',
                speed: '510 kts',
                squawk: '7421',
                vspeed: '0 fpm',
                lat: 51.8,
                lng: -1.2,
                heading: 285
            },
            'VS3': {
                callsign: 'VS3',
                airline: 'Virgin Atlantic',
                aircraft: 'Airbus A350-1000',
                registration: 'G-VLUX',
                origin: 'LHR',
                originCity: 'London',
                destination: 'JFK',
                destCity: 'New York',
                status: 'Delayed 15m',
                isDelayed: true,
                progress: 0,
                remaining: '7h 45m',
                depTime: '02:15 PM',
                arrTime: '05:05 PM',
                depGate: 'Terminal 3, A15',
                arrGate: 'Terminal 4, B31',
                altitude: '--',
                speed: '--',
                squawk: '--',
                vspeed: '--',
                lat: 51.47,
                lng: -0.46,
                heading: 270
            },
            'UA924': {
                callsign: 'UA924',
                airline: 'United Airlines',
                aircraft: 'Boeing 787-10',
                registration: 'N12006',
                origin: 'IAD',
                originCity: 'Washington',
                destination: 'LHR',
                destCity: 'London',
                status: 'On Time',
                isDelayed: false,
                progress: 35,
                remaining: '5h 20m',
                depTime: '06:40 PM',
                arrTime: '06:50 AM',
                depGate: 'Terminal C, 12',
                arrGate: 'Terminal 2, B56',
                altitude: '38,000 ft',
                speed: '520 kts',
                squawk: '5523',
                vspeed: '+150 fpm',
                lat: 52.5,
                lng: -25.0,
                heading: 65
            },
            'BA458': {
                callsign: 'BA458',
                airline: 'British Airways',
                aircraft: 'Airbus A320',
                registration: 'G-EUYT',
                origin: 'LHR',
                originCity: 'London',
                destination: 'CDG',
                destCity: 'Paris',
                status: 'On Time',
                isDelayed: false,
                progress: 67,
                remaining: '1h 10m',
                depTime: '02:15 PM',
                arrTime: '04:35 PM',
                depGate: 'Terminal 5, A10',
                arrGate: 'Terminal 2E, K45',
                altitude: '32,000 ft',
                speed: '450 kts',
                squawk: '4521',
                vspeed: '0 fpm',
                lat: 50.5,
                lng: 0.5,
                heading: 135
            }
        };

        // ==================== VIEW MANAGEMENT ====================
        function showView(viewName) {
            const homeView = document.getElementById('home-view');
            const mapView = document.getElementById('map-view');
            const detailsView = document.getElementById('details-view');
            const mainFooter = document.getElementById('main-footer');
            const mobileNav = document.getElementById('mobile-nav');

            // Hide all views
            homeView.classList.add('view-hidden');
            mapView.classList.add('view-hidden');
            detailsView.classList.add('view-hidden');
            mainFooter.classList.add('view-hidden');

            // Reset nav buttons
            document.querySelectorAll('#mobile-nav button').forEach(btn => {
                btn.classList.remove('text-sky');
                btn.classList.add('text-cloud/40');
                const icon = btn.querySelector('.material-symbols-outlined');
                if (icon) icon.style.fontVariationSettings = "'FILL' 0";
            });

            if (viewName === 'home') {
                homeView.classList.remove('view-hidden');
                mainFooter.classList.remove('view-hidden');
                mobileNav.classList.remove('view-hidden');
                document.body.style.overflow = 'auto';
                document.getElementById('nav-home').classList.add('text-sky');
                document.getElementById('nav-home').classList.remove('text-cloud/40');
                document.getElementById('nav-home').querySelector('.material-symbols-outlined').style.fontVariationSettings = "'FILL' 1";
                window.scrollTo(0, 0);
            } else if (viewName === 'map') {
                mapView.classList.remove('view-hidden');
                mobileNav.classList.add('view-hidden');
                document.body.style.overflow = 'hidden';
                setTimeout(() => {
                    initMap();
                    if (map) map.invalidateSize();
                }, 100);
            } else if (viewName === 'details') {
                detailsView.classList.remove('view-hidden');
                mobileNav.classList.add('view-hidden');
                document.body.style.overflow = 'auto';
                window.scrollTo(0, 0);
            }
        }

        // ==================== MAP FUNCTIONS ====================
        function initMap() {
            if (map) return;

            map = L.map('leaflet-map', {
                center: [54.0, -2.0],
                zoom: 6,
                zoomControl: false
            });

            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                maxZoom: 19,
                subdomains: 'abcd'
            }).addTo(map);

            L.control.zoom({ position: 'topright' }).addTo(map);

            loadFlights();
            document.getElementById('map-loading').classList.add('view-hidden');
        }

        function createAircraftIcon(heading, isSelected = false) {
            const color = isSelected ? '#00D1FF' : '#F0F4F8';
            const size = isSelected ? 32 : 24;
            return L.divIcon({
                className: 'aircraft-marker',
                html: `<svg width="${size}" height="${size}" viewBox="0 0 24 24" style="transform: rotate(${heading}deg); filter: drop-shadow(0 0 ${isSelected ? '8px' : '3px'} ${isSelected ? 'rgba(0,209,255,0.8)' : 'rgba(0,0,0,0.5)'});">
                    <path fill="${color}" d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
                </svg>`,
                iconSize: [size, size],
                iconAnchor: [size/2, size/2]
            });
        }

        function loadFlights() {
            Object.values(FLIGHTS_DATA).forEach(flight => {
                if (!flight.lat || !flight.lng) return;
                
                const marker = L.marker([flight.lat, flight.lng], {
                    icon: createAircraftIcon(flight.heading, false)
                }).addTo(map);

                marker.on('click', () => selectFlightOnMap(flight));
                flightMarkers[flight.callsign] = marker;
            });
        }

        function selectFlightOnMap(flight) {
            selectedFlight = flight;
            
            // Update all markers
            Object.entries(flightMarkers).forEach(([callsign, marker]) => {
                const f = FLIGHTS_DATA[callsign];
                marker.setIcon(createAircraftIcon(f.heading, callsign === flight.callsign));
            });

            // Update flight card
            document.getElementById('map-flight-callsign').textContent = flight.callsign;
            document.getElementById('map-flight-airline').textContent = `${flight.airline} • ${flight.aircraft}`;
            document.getElementById('map-flight-origin').textContent = flight.origin;
            document.getElementById('map-flight-dest').textContent = flight.destination;
            document.getElementById('map-flight-progress').style.width = `${flight.progress}%`;
            
            const statusEl = document.getElementById('map-flight-status');
            statusEl.textContent = flight.status;
            statusEl.className = `px-2 py-0.5 rounded text-[10px] font-bold uppercase ${flight.isDelayed ? 'status-delayed' : 'status-on-time'} border`;

            document.getElementById('map-flight-card').classList.remove('view-hidden');
            
            map.flyTo([flight.lat, flight.lng], 8, { duration: 0.5 });
        }

        function hideMapFlightCard() {
            document.getElementById('map-flight-card').classList.add('view-hidden');
        }

        function centerOnUserLocation() {
            if ('geolocation' in navigator) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        map.flyTo([pos.coords.latitude, pos.coords.longitude], 10);
                        showToast('Centered on your location', 'my_location');
                    },
                    () => showToast('Could not get location', 'location_off')
                );
            }
        }

        function centerOnLHR() {
            if (map) {
                map.flyTo([51.47, -0.46], 10, { duration: 0.5 });
                showToast('Centered on London Heathrow', 'location_on');
            }
        }

        function toggleMapLayers() {
            showToast('Map layers coming soon!', 'layers');
        }

        // ==================== FLIGHT DETAILS ====================
        function showFlightDetails(callsign) {
            const flight = FLIGHTS_DATA[callsign];
            if (!flight) {
                showToast('Flight not found', 'error');
                return;
            }

            // Update details view
            document.getElementById('details-title').textContent = `${flight.callsign} Status`;
            document.getElementById('details-origin').textContent = flight.origin;
            document.getElementById('details-origin-city').textContent = flight.originCity;
            document.getElementById('details-dest').textContent = flight.destination;
            document.getElementById('details-dest-city').textContent = flight.destCity;
            document.getElementById('details-status').textContent = flight.isDelayed ? 'Delayed' : 'En Route - On Time';
            document.getElementById('details-status').className = flight.isDelayed ? 'text-warning text-sm font-bold mt-2' : 'text-sky text-sm font-bold mt-2';
            document.getElementById('details-aircraft').textContent = `${flight.aircraft} • ${flight.registration}`;
            document.getElementById('details-remaining').textContent = flight.remaining;
            document.getElementById('details-percent').textContent = `${flight.progress}% Completed`;
            document.getElementById('details-progress-bar').style.width = `${flight.progress}%`;
            document.getElementById('details-dep-time').textContent = `Departed: ${flight.depTime}`;
            document.getElementById('details-arr-time').textContent = `Est. Arrival: ${flight.arrTime}`;
            document.getElementById('details-dep-gate').textContent = flight.depGate;
            document.getElementById('details-arr-gate').textContent = flight.arrGate;
            document.getElementById('details-altitude').textContent = flight.altitude;
            document.getElementById('details-speed').textContent = flight.speed;
            document.getElementById('details-squawk').textContent = flight.squawk;
            document.getElementById('details-vspeed').textContent = flight.vspeed;
            document.getElementById('details-route-info').textContent = `This ${flight.airline} flight operates between ${flight.originCity} (${flight.origin}) and ${flight.destCity} (${flight.destination}). Track this flight in real-time with FlightpulseUK for the most accurate status updates.`;

            showView('details');
        }

        // ==================== SEARCH ====================
        function handleSearch(event) {
            if (event.key === 'Enter') {
                performSearch();
            }
        }

        function performSearch() {
            const query = document.getElementById('main-search').value.trim().toUpperCase();
            if (!query) {
                showToast('Please enter a flight number', 'search');
                return;
            }

            if (FLIGHTS_DATA[query]) {
                showFlightDetails(query);
            } else {
                showToast(`Searching for "${query}"...`, 'search');
                setTimeout(() => showToast('Flight not found in demo data', 'info'), 1500);
            }
        }

        function searchFlight(callsign) {
            if (FLIGHTS_DATA[callsign]) {
                showFlightDetails(callsign);
            } else {
                showToast(`Searching for ${callsign}...`, 'search');
            }
        }

        function searchRoute(origin, dest) {
            showToast(`Searching ${origin} to ${dest}...`, 'route');
            // Find matching flight
            const flight = Object.values(FLIGHTS_DATA).find(f => f.origin === origin && f.destination === dest);
            if (flight) {
                setTimeout(() => showFlightDetails(flight.callsign), 500);
            }
        }

        function clearRecentSearches() {
            showToast('Recent searches cleared', 'delete');
        }

        // ==================== UTILITY FUNCTIONS ====================
        function showToast(message, icon = 'info') {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').textContent = message;
            document.getElementById('toast-icon').textContent = icon;
            
            toast.classList.remove('opacity-0', '-translate-y-4', 'pointer-events-none');
            toast.classList.add('opacity-100', 'translate-y-0');
            
            setTimeout(() => {
                toast.classList.add('opacity-0', '-translate-y-4', 'pointer-events-none');
                toast.classList.remove('opacity-100', 'translate-y-0');
            }, 3000);
        }

        function openModal(modalId) {
            document.getElementById(modalId).classList.remove('view-hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('view-hidden');
            if (!document.getElementById('map-view').classList.contains('view-hidden')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = 'auto';
            }
        }

        function subscribeToAlerts() {
            showToast('You will receive alerts for this flight!', 'notifications_active');
        }

        function shareFlight() {
            if (navigator.share) {
                navigator.share({
                    title: 'Flight Status - FlightpulseUK',
                    text: 'Track this flight in real-time!',
                    url: window.location.href
                });
            } else {
                showToast('Link copied to clipboard!', 'link');
            }
        }

        function toggleTheme() {
            showToast('Theme toggle coming soon!', 'light_mode');
        }

        // ==================== INIT ====================
        document.addEventListener('DOMContentLoaded', () => {
            showView('home');
        });
    </script>
</body>
</html>